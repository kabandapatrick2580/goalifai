2025-10-07 17:59:22,584 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-06T00:02:12.725805'}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T00:28:01.312263'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 17:59:22,597 - app - INFO - Allocated 533.3333333333332800 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:70]
2025-10-07 17:59:22,603 - app - INFO - Allocated 266.6666666666666400 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:70]
2025-10-07 17:59:22,603 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 533.3333333333333}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 266.66666666666663}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:78]
2025-10-07 18:00:12,898 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-06T00:02:12.725805'}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T00:28:01.312263'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 18:00:12,911 - app - INFO - Allocated 1332533.3333333332000800 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:70]
2025-10-07 18:00:12,917 - app - INFO - Allocated 666266.6666666666000400 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:70]
2025-10-07 18:00:12,917 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 1332533.3333333333}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 666266.6666666666}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:78]
2025-10-07 18:08:38,351 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-06T00:02:12.725805'}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T00:28:01.312263'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 18:08:38,364 - app - INFO - Allocated 1332533.3333333332000800 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:71]
2025-10-07 18:08:38,370 - app - INFO - Allocated 666266.6666666666000400 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:71]
2025-10-07 18:08:38,370 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 1332533.3333333333}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 666266.6666666666}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:79]
2025-10-07 18:08:50,650 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-06T00:02:12.725805'}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T00:28:01.312263'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 18:08:50,664 - app - INFO - Allocated 1332533.3333333332000800 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:71]
2025-10-07 18:08:50,671 - app - INFO - Allocated 666266.6666666666000400 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:71]
2025-10-07 18:08:50,671 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 1332533.3333333333}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 666266.6666666666}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:79]
2025-10-07 18:09:54,798 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-06T00:02:12.725805'}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T00:28:01.312263'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 18:09:54,818 - app - INFO - Allocated 0.00 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:71]
2025-10-07 18:09:54,824 - app - INFO - Allocated 0.00 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:71]
2025-10-07 18:09:54,824 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 0.0}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 0.0}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:79]
2025-10-07 18:15:09,072 - app - ERROR - Error during allocation recalculation: 400 Bad Request: Failed to decode JSON object: Expecting property name enclosed in double quotes: line 6 column 5 (char 134) - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:91]
2025-10-07 18:15:09,083 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/local-env/lib/python3.12/site-packages/werkzeug/wrappers/request.py", line 611, in get_json
    rv = self.json_module.loads(data)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/patrick/goalifai/local-env/lib/python3.12/site-packages/flask/json/provider.py", line 187, in loads
    return json.loads(s, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/json/decoder.py", line 353, in raw_decode
    obj, end = self.scan_once(s, idx)
               ^^^^^^^^^^^^^^^^^^^^^^
json.decoder.JSONDecodeError: Expecting property name enclosed in double quotes: line 6 column 5 (char 134)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 24, in recalculate_allocations
    data = request.get_json()
           ^^^^^^^^^^^^^^^^^^
  File "/home/patrick/goalifai/local-env/lib/python3.12/site-packages/werkzeug/wrappers/request.py", line 620, in get_json
    rv = self.on_json_loading_failed(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/patrick/goalifai/local-env/lib/python3.12/site-packages/flask/wrappers.py", line 214, in on_json_loading_failed
    return super().on_json_loading_failed(e)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/patrick/goalifai/local-env/lib/python3.12/site-packages/werkzeug/wrappers/request.py", line 645, in on_json_loading_failed
    raise BadRequest(f"Failed to decode JSON object: {e}")
werkzeug.exceptions.BadRequest: 400 Bad Request: Failed to decode JSON object: Expecting property name enclosed in double quotes: line 6 column 5 (char 134)
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:92]
2025-10-07 18:15:16,275 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-06T00:02:12.725805'}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T00:28:01.312263'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 18:15:16,297 - app - INFO - Allocated 1332533.3333333332000800 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:75]
2025-10-07 18:15:16,303 - app - INFO - Allocated 50000.0 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:75]
2025-10-07 18:15:16,304 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 1332533.3333333333}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 50000.0}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:83]
2025-10-07 18:15:36,539 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-06T00:02:12.725805'}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T00:28:01.312263'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 18:15:36,554 - app - INFO - Allocated 5000000.0 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:75]
2025-10-07 18:15:36,558 - app - INFO - Allocated 50000.0 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:75]
2025-10-07 18:15:36,558 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 5000000.0}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 50000.0}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:83]
2025-10-07 18:18:20,831 - app - ERROR - Error finalizing allocations for month 2025-10: 'dict' object has no attribute 'is_finalized' - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:129]
2025-10-07 18:18:20,833 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 112, in finalize_allocations
    if allocation.is_finalized:
       ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'is_finalized'
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:130]
2025-10-07 18:18:31,513 - app - ERROR - Error finalizing allocations for month 2025-10: 'dict' object has no attribute 'is_finalized' - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:129]
2025-10-07 18:18:31,515 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 112, in finalize_allocations
    if allocation.is_finalized:
       ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'is_finalized'
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:130]
2025-10-07 18:19:01,659 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-06T00:02:12.725805'}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 0.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T00:28:01.312263'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 18:19:01,666 - app - INFO - Allocated 1332533.3333333332000800 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:75]
2025-10-07 18:19:01,670 - app - INFO - Allocated 50000.0 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:75]
2025-10-07 18:19:01,670 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 1332533.3333333333}, {'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 50000.0}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:83]
2025-10-07 18:19:20,179 - app - ERROR - Error finalizing allocations for month 2025-10: 'dict' object has no attribute 'is_finalized' - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:129]
2025-10-07 18:19:20,180 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 112, in finalize_allocations
    if allocation.is_finalized:
       ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'is_finalized'
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:130]
2025-10-07 18:20:48,630 - app - ERROR - Error finalizing allocations for month 2025-10: 'dict' object has no attribute 'is_completed' - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:129]
2025-10-07 18:20:48,632 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 112, in finalize_allocations
    if allocation.is_completed:
       ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'is_completed'
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:130]
2025-10-07 18:23:02,694 - app - ERROR - Error finalizing allocations for month 2025-10: 'is_finalized' - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:129]
2025-10-07 18:23:02,695 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 112, in finalize_allocations
    if allocation['is_finalized']:
       ~~~~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 'is_finalized'
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:130]
2025-10-07 18:26:28,087 - app - INFO - Finalizing allocations for month 2025-10: [{'allocation_id': 'c43ec39f-4385-4d5c-a747-0a14d25e71bb', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'month': '2025-10', 'allocated_amount': 50000.0, 'created_at': '2025-10-07T00:28:09.538595', 'updated_at': '2025-10-07T18:15:16.299703'}, {'allocation_id': '27e8b38b-bba8-47ef-bc31-3b935b716bf0', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'month': '2025-10', 'allocated_amount': 1332533.33, 'created_at': '2025-10-07T00:11:44.083376', 'updated_at': '2025-10-07T18:19:01.661258'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:110]
2025-10-07 18:26:28,087 - app - ERROR - Error finalizing allocations for month 2025-10: 'is_finalized' - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:130]
2025-10-07 18:26:28,088 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 113, in finalize_allocations
    if allocation['is_finalized']:
       ~~~~~~~~~~^^^^^^^^^^^^^^^^
KeyError: 'is_finalized'
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:131]
2025-10-07 18:40:41,715 - app - INFO - Finalizing allocations for month 2025-10: {'7c75f482-dba6-4322-86d6-7bb1914d8eb7': {'goal_name': 'Trip to Kbuye', 'total_allocated': 50000.0, 'allocations': [{'allocation_id': 'c43ec39f-4385-4d5c-a747-0a14d25e71bb', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 50000.0, 'created_at': '2025-10-07T00:28:09.538595', 'updated_at': '2025-10-07T18:15:16.299703', 'is_finalized': None, 'is_deficit': None}]}, 'd033c7a1-95de-4f17-acf7-caf87aa1238d': {'goal_name': 'Plot of a land', 'total_allocated': 1332533.33, 'allocations': [{'allocation_id': '27e8b38b-bba8-47ef-bc31-3b935b716bf0', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 1332533.33, 'created_at': '2025-10-07T00:11:44.083376', 'updated_at': '2025-10-07T18:19:01.661258', 'is_finalized': None, 'is_deficit': None}]}} - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:110]
2025-10-07 18:40:41,726 - app - ERROR - Error finalizing allocations for month 2025-10: 'dict' object has no attribute 'current_amount' - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:141]
2025-10-07 18:40:41,729 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 134, in finalize_allocations
    goal.current_amount += total_allocated_for_goal
    ^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute 'current_amount'
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:142]
2025-10-07 18:42:27,668 - app - INFO - Finalizing allocations for month 2025-10: {'7c75f482-dba6-4322-86d6-7bb1914d8eb7': {'goal_name': 'Trip to Kbuye', 'total_allocated': 50000.0, 'allocations': [{'allocation_id': 'c43ec39f-4385-4d5c-a747-0a14d25e71bb', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 50000.0, 'created_at': '2025-10-07T00:28:09.538595', 'updated_at': '2025-10-07T18:15:16.299703', 'is_finalized': None, 'is_deficit': None}]}, 'd033c7a1-95de-4f17-acf7-caf87aa1238d': {'goal_name': 'Plot of a land', 'total_allocated': 1332533.33, 'allocations': [{'allocation_id': '27e8b38b-bba8-47ef-bc31-3b935b716bf0', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 1332533.33, 'created_at': '2025-10-07T00:11:44.083376', 'updated_at': '2025-10-07T18:19:01.661258', 'is_finalized': None, 'is_deficit': None}]}} - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:110]
2025-10-07 18:42:27,680 - app - ERROR - Error finalizing allocations for month 2025-10: Class 'builtins.dict' is not mapped - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:141]
2025-10-07 18:42:27,684 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/local-env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3477, in add
    state = attributes.instance_state(instance)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'dict' object has no attribute '_sa_instance_state'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 135, in finalize_allocations
    db.session.add(goal)
  File "/home/patrick/goalifai/local-env/lib/python3.12/site-packages/sqlalchemy/orm/scoping.py", line 380, in add
    return self._proxied.add(instance, _warn=_warn)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/patrick/goalifai/local-env/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 3479, in add
    raise exc.UnmappedInstanceError(instance) from err
sqlalchemy.orm.exc.UnmappedInstanceError: Class 'builtins.dict' is not mapped
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:142]
2025-10-07 18:46:24,177 - app - INFO - Finalizing allocations for month 2025-10: {'7c75f482-dba6-4322-86d6-7bb1914d8eb7': {'goal_name': 'Trip to Kbuye', 'total_allocated': 50000.0, 'allocations': [{'allocation_id': 'c43ec39f-4385-4d5c-a747-0a14d25e71bb', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 50000.0, 'created_at': '2025-10-07T00:28:09.538595', 'updated_at': '2025-10-07T18:15:16.299703', 'is_finalized': None, 'is_deficit': None}]}, 'd033c7a1-95de-4f17-acf7-caf87aa1238d': {'goal_name': 'Plot of a land', 'total_allocated': 1332533.33, 'allocations': [{'allocation_id': '27e8b38b-bba8-47ef-bc31-3b935b716bf0', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 1332533.33, 'created_at': '2025-10-07T00:11:44.083376', 'updated_at': '2025-10-07T18:19:01.661258', 'is_finalized': None, 'is_deficit': None}]}} - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:110]
2025-10-07 18:46:24,185 - app - ERROR - Error finalizing allocations for month 2025-10: 'Goal' object is not subscriptable - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:141]
2025-10-07 18:46:24,186 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 134, in finalize_allocations
    goal['current_amount'] += total_allocated_for_goal
    ~~~~^^^^^^^^^^^^^^^^^^
TypeError: 'Goal' object is not subscriptable
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:142]
2025-10-07 18:46:53,740 - app - INFO - Finalizing allocations for month 2025-10: {'7c75f482-dba6-4322-86d6-7bb1914d8eb7': {'goal_name': 'Trip to Kbuye', 'total_allocated': 50000.0, 'allocations': [{'allocation_id': 'c43ec39f-4385-4d5c-a747-0a14d25e71bb', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 50000.0, 'created_at': '2025-10-07T00:28:09.538595', 'updated_at': '2025-10-07T18:15:16.299703', 'is_finalized': None, 'is_deficit': None}]}, 'd033c7a1-95de-4f17-acf7-caf87aa1238d': {'goal_name': 'Plot of a land', 'total_allocated': 1332533.33, 'allocations': [{'allocation_id': '27e8b38b-bba8-47ef-bc31-3b935b716bf0', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 1332533.33, 'created_at': '2025-10-07T00:11:44.083376', 'updated_at': '2025-10-07T18:19:01.661258', 'is_finalized': None, 'is_deficit': None}]}} - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:110]
2025-10-07 18:46:53,749 - app - ERROR - Error finalizing allocations for month 2025-10: unsupported operand type(s) for +=: 'decimal.Decimal' and 'float' - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:141]
2025-10-07 18:46:53,750 - app - ERROR - Traceback (most recent call last):
  File "/home/patrick/goalifai/app/api/v1/client/goal_recalculation.py", line 134, in finalize_allocations
    goal.current_amount += total_allocated_for_goal
TypeError: unsupported operand type(s) for +=: 'decimal.Decimal' and 'float'
 - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:142]
2025-10-07 18:47:37,513 - app - INFO - Finalizing allocations for month 2025-10: {'7c75f482-dba6-4322-86d6-7bb1914d8eb7': {'goal_name': 'Trip to Kbuye', 'total_allocated': 50000.0, 'allocations': [{'allocation_id': 'c43ec39f-4385-4d5c-a747-0a14d25e71bb', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 50000.0, 'created_at': '2025-10-07T00:28:09.538595', 'updated_at': '2025-10-07T18:15:16.299703', 'is_finalized': None, 'is_deficit': None}]}, 'd033c7a1-95de-4f17-acf7-caf87aa1238d': {'goal_name': 'Plot of a land', 'total_allocated': 1332533.33, 'allocations': [{'allocation_id': '27e8b38b-bba8-47ef-bc31-3b935b716bf0', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'month': '2025-10', 'allocated_amount': 1332533.33, 'created_at': '2025-10-07T00:11:44.083376', 'updated_at': '2025-10-07T18:19:01.661258', 'is_finalized': None, 'is_deficit': None}]}} - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:110]
2025-10-07 18:50:14,110 - app - INFO - All goals for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Trip to Kbuye', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 50000.0, 'current_amount': 50000.0, 'monthly_contribution': 0.0, 'priority': {'priority_id': '162a5ab3-a236-4b49-8319-2fc43728f64f', 'name': 'low', 'percentage': 40.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-07T00:28:01.312258', 'updated_at': '2025-10-07T18:47:37.522136'}, {'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'user_id': 'f280eb9e-063d-40ae-83f2-8c47aeb9ea3f', 'title': 'Plot of a land', 'description': None, 'category_id': UUID('3a6b20c4-9d0c-4417-a5eb-04c395cb290d'), 'target_amount': 5000000.0, 'current_amount': 1332533.33, 'monthly_contribution': 0.0, 'priority': {'priority_id': '5402090c-99d9-475a-820a-bf9398a22055', 'name': 'high', 'percentage': 80.0}, 'due_date': None, 'expected_completion_date': None, 'funding_gap': 0, 'status': 'in progress', 'is_completed': False, 'is_active': True, 'created_at': '2025-10-06T00:02:12.725802', 'updated_at': '2025-10-07T18:47:37.529979'}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:38]
2025-10-07 18:50:14,122 - app - INFO - Allocated 0.0 to goal Trip to Kbuye for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:75]
2025-10-07 18:50:14,133 - app - INFO - Allocated 665866.6666666666000800 to goal Plot of a land for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:75]
2025-10-07 18:50:14,134 - app - INFO - Allocation summary for user f280eb9e-063d-40ae-83f2-8c47aeb9ea3f: [{'goal_id': '7c75f482-dba6-4322-86d6-7bb1914d8eb7', 'goal_title': 'Trip to Kbuye', 'allocated_amount': 0.0}, {'goal_id': 'd033c7a1-95de-4f17-acf7-caf87aa1238d', 'goal_title': 'Plot of a land', 'allocated_amount': 665866.6666666666}] - [in /home/patrick/goalifai/app/api/v1/client/goal_recalculation.py:83]
